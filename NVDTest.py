import requests
import xml.etree.ElementTree as ET

xml_filename= "scan.xml"
def getCVETag(xml_file):
    # Parse the XML file
    tree = ET.parse(xml_file)
    root = tree.getroot()

    # List to store the strings between tags
    CVE = []

    # Find all "elem" tags in the XML tree
    elems = root.findall(".//elem")

    # Traverse each "elem" tag and get the text content
    for elem in elems:
        if "key" in elem.attrib and elem.attrib["key"] == "id":
            text = elem.text
            if text is not None:
                CVE.append(text.strip())

    return CVE
def get_cve_details(cve_numbers):
    base_url = "https://services.nvd.nist.gov/rest/json/cve/1.0"
    results = []

    for cve_number in cve_numbers:
        url = f"{base_url}/{cve_number}"
        response = requests.get(url)
        if response.status_code == 200:
            cve_data = response.json()
            results.append(cve_data)
        else:
            print(f"Failed to retrieve details for CVE-{cve_number}")

    return results

# File to write the results
output_file = "cve_details.txt"

# Write the results to the file
with open(output_file, "w") as file:
    for cve_data in cve_details:
        file.write(str(cve_data))
        file.write("\n---\n")


# Example usage
cve_numbers = getCVETag(xml_filename)  # Replace with your desired CVE numbers
get_cve_details(cve_numbers)


#ToDo CVE No. from XML

#ToDo CVE into NVD Database
#ToDo Result from the NVD into nice looking WhatSoEver


#ToDo for each IP in the network topology start one client
#ToDo Get all Client results and sum up in one xml includign mapping

#ToDo the stupid graph we all do not understand how it is build

#ToDo Present results one a localhost webside




