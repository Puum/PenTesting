import requests
import xml.etree.ElementTree as ET

def get_cve_details(cve_number):
    url = f"https://services.nvd.nist.gov/rest/json/cve/1.0/{cve_number}"
    response = requests.get(url)
    if response.status_code == 200:
        return response.text
    else:
        return None

def save_xml(data, filename):
    with open(filename, "w") as file:
        file.write(data)

# Example usage
cve_numbers = ["CVE-2021-34567", "CVE-2021-12345"]  # Replace with your desired CVE numbers

for cve in cve_numbers:
    cve_data = get_cve_details(cve)
    if cve_data:
        xml_filename = f"{cve}.xml"
        save_xml(cve_data, xml_filename)
        print(f"CVE {cve} details saved to {xml_filename}")
    else:
        print(f"Failed to retrieve details for CVE {cve}")

#ToDo CVE No. from XML
#ToDo CVE into NVD Database
#ToDo Result from the NVD into nice looking WhatSoEver


#ToDo for each IP in the network topology start one client
#ToDo Get all Client results and sum up in one xml includign mapping

#ToDo the stupid graph we all do not understand how it is build

#ToDo Present results one a localhost webside




